var languageTables = {
    "processing": "Подождите...",
    "search": "Поиск:",
    "lengthMenu": "Показать _MENU_ записей",
    "info": "Записи с _START_ до _END_ из _TOTAL_ записей",
    "infoEmpty": "Записи с 0 до 0 из 0 записей",
    "infoFiltered": "(отфильтровано из _MAX_ записей)",
    "loadingRecords": "Загрузка записей...",
    "zeroRecords": "Записи отсутствуют.",
    "emptyTable": "В таблице отсутствуют данные",
    "paginate": {
        "first": "Первая",
        "previous": "Предыдущая",
        "next": "Следующая",
        "last": "Последняя"
    },
    "aria": {
        "sortAscending": ": активировать для сортировки столбца по возрастанию",
        "sortDescending": ": активировать для сортировки столбца по убыванию"
    },
    "select": {
        "rows": {
            "_": "Выбрано записей: %d",
            "1": "Выбрана одна запись"
        },
        "cells": {
            "_": "Выбрано %d ячеек",
            "1": "Выбрана 1 ячейка "
        },
        "columns": {
            "1": "Выбран 1 столбец ",
            "_": "Выбрано %d столбцов "
        }
    },
    "searchBuilder": {
        "conditions": {
            "string": {
                "startsWith": "Начинается с",
                "contains": "Содержит",
                "empty": "Пусто",
                "endsWith": "Заканчивается на",
                "equals": "Равно",
                "not": "Не",
                "notEmpty": "Не пусто",
                "notContains": "Не содержит",
                "notStartsWith": "Не начинается на",
                "notEndsWith": "Не заканчивается на"
            },
            "date": {
                "after": "После",
                "before": "До",
                "between": "Между",
                "empty": "Пусто",
                "equals": "Равно",
                "not": "Не",
                "notBetween": "Не между",
                "notEmpty": "Не пусто"
            },
            "number": {
                "empty": "Пусто",
                "equals": "Равно",
                "gt": "Больше чем",
                "gte": "Больше, чем равно",
                "lt": "Меньше чем",
                "lte": "Меньше, чем равно",
                "not": "Не",
                "notEmpty": "Не пусто",
                "between": "Между",
                "notBetween": "Не между ними"
            },
            "array": {
                "equals": "Равно",
                "empty": "Пусто",
                "contains": "Содержит",
                "not": "Не равно",
                "notEmpty": "Не пусто",
                "without": "Без"
            }
        },
        "data": "Данные",
        "deleteTitle": "Удалить условие фильтрации",
        "logicAnd": "И",
        "logicOr": "Или",
        "title": {
            "0": "Конструктор поиска",
            "_": "Конструктор поиска (%d)"
        },
        "value": "Значение",
        "add": "Добавить условие",
        "button": {
            "0": "Конструктор поиска",
            "_": "Конструктор поиска (%d)"
        },
        "clearAll": "Очистить всё",
        "condition": "Условие",
        "leftTitle": "Превосходные критерии",
        "rightTitle": "Критерии отступа"
    },
    "searchPanes": {
        "clearMessage": "Очистить всё",
        "collapse": {
            "0": "Панели поиска",
            "_": "Панели поиска (%d)"
        },
        "count": "{total}",
        "countFiltered": "{shown} ({total})",
        "emptyPanes": "Нет панелей поиска",
        "loadMessage": "Загрузка панелей поиска",
        "title": "Фильтры активны - %d",
        "showMessage": "Показать все",
        "collapseMessage": "Скрыть все"
    },
    "buttons": {
        "pdf": "PDF",
        "print": "Печать",
        "collection": "Коллекция <span class=\"ui-button-icon-primary ui-icon ui-icon-triangle-1-s\"><\/span>",
        "colvis": "Видимость столбцов",
        "colvisRestore": "Восстановить видимость",
        "copy": "Копировать",
        "copyKeys": "Нажмите ctrl or u2318 + C, чтобы скопировать данные таблицы в буфер обмена.  Для отмены, щелкните по сообщению или нажмите escape.",
        "copyTitle": "Скопировать в буфер обмена",
        "csv": "CSV",
        "excel": "Excel",
        "pageLength": {
            "-1": "Показать все строки",
            "_": "Показать %d строк",
            "1": "Показать 1 строку"
        },
        "removeState": "Удалить",
        "renameState": "Переименовать",
        "copySuccess": {
            "1": "Строка скопирована в буфер обмена",
            "_": "Скопировано %d строк в буфер обмена"
        },
        "createState": "Создать состояние",
        "removeAllStates": "Удалить все состояния",
        "savedStates": "Сохраненные состояния",
        "stateRestore": "Состояние %d",
        "updateState": "Обновить"
    },
    "decimal": ".",
    "infoThousands": ",",
    "autoFill": {
        "cancel": "Отменить",
        "fill": "Заполнить все ячейки <i>%d<i><\/i><\/i>",
        "fillHorizontal": "Заполнить ячейки по горизонтали",
        "fillVertical": "Заполнить ячейки по вертикали",
        "info": "Информация"
    },
    "datetime": {
        "previous": "Предыдущий",
        "next": "Следующий",
        "hours": "Часы",
        "minutes": "Минуты",
        "seconds": "Секунды",
        "unknown": "Неизвестный",
        "amPm": [
            "AM",
            "PM"
        ],
        "months": {
            "0": "Январь",
            "1": "Февраль",
            "10": "Ноябрь",
            "11": "Декабрь",
            "2": "Март",
            "3": "Апрель",
            "4": "Май",
            "5": "Июнь",
            "6": "Июль",
            "7": "Август",
            "8": "Сентябрь",
            "9": "Октябрь"
        },
        "weekdays": [
            "Вс",
            "Пн",
            "Вт",
            "Ср",
            "Чт",
            "Пт",
            "Сб"
        ]
    },
    "editor": {
        "close": "Закрыть",
        "create": {
            "button": "Новый",
            "title": "Создать новую запись",
            "submit": "Создать"
        },
        "edit": {
            "button": "Изменить",
            "title": "Изменить запись",
            "submit": "Изменить"
        },
        "remove": {
            "button": "Удалить",
            "title": "Удалить",
            "submit": "Удалить",
            "confirm": {
                "_": "Вы точно хотите удалить %d строк?",
                "1": "Вы точно хотите удалить 1 строку?"
            }
        },
        "multi": {
            "restore": "Отменить изменения",
            "title": "Несколько значений",
            "noMulti": "Это поле должно редактироватся отдельно, а не как часть групы",
            "info": "Выбранные элементы содержат разные значения для этого входа.  Чтобы отредактировать и установить для всех элементов этого ввода одинаковое значение, нажмите или коснитесь здесь, в противном случае они сохранят свои индивидуальные значения."
        },
        "error": {
            "system": "Возникла системная ошибка (<a target=\"\\\" rel=\"nofollow\" href=\"\\\">Подробнее<\/a>)."
        }
    },
    "searchPlaceholder": "Что ищете?",
    "stateRestore": {
        "creationModal": {
            "button": "Создать",
            "search": "Поиск",
            "columns": {
                "search": "Поиск по столбцам",
                "visible": "Видимость столбцов"
            },
            "name": "Имя:",
            "order": "Сортировка",
            "paging": "Страницы",
            "scroller": "Позиция прокрутки",
            "searchBuilder": "Редактор поиска",
            "select": "Выделение",
            "title": "Создать новое состояние",
            "toggleLabel": "Включает:"
        },
        "removeJoiner": "и",
        "removeSubmit": "Удалить",
        "renameButton": "Переименовать",
        "duplicateError": "Состояние с таким именем уже существует.",
        "emptyError": "Имя не может быть пустым.",
        "emptyStates": "Нет сохраненных состояний",
        "removeConfirm": "Вы уверены, что хотите удалить %s?",
        "removeError": "Не удалось удалить состояние.",
        "removeTitle": "Удалить состояние",
        "renameLabel": "Новое имя для %s:",
        "renameTitle": "Переименовать состояние"
    },
    "thousands": " "
};

var spiner = '<div class="container"><div class="row text-center justify-content-center">';
spiner = spiner + '<div class="spinner-border" role="status"><span class="sr-only"></span></div></div></div>';

$(document).ready(function () {
    var tableGalleryWorks = $('#gallery-works-tables').dataTable({
        "language": languageTables
    });

    const searchParams = new URLSearchParams(window.location.search);

    if (searchParams.has('paintings-id')) {
        $('#dashbord-baget').hide();
        $('#paintings-tab').addClass("active");
        $('#paintings').addClass("active");
        $('#paintings').addClass("show");
        getPaintingsByIdUrlRequest(searchParams.get('paintings-id'))
    }

    // Переключение табов и загрузка контента под таб
    function getCatalogRequest(typeCatalog) {
        $('#plast').html('');
        $('#wood').html('');
        $('#alum').html('');
        $('#pasp').html('');
        $('#promokod-container').html('');
        $('#feed-back').html('');

        if (typeCatalog == 'promokod') {
            $('#dashbord-baget').hide();
            getinfoPromoCodeRequest();

            return;
        }

        if (typeCatalog == 'static') {
            $('#dashbord-baget').hide();
            getStaticRequest();

            return;
        }

        if (typeCatalog == 'paintings') {
            $('#dashbord-baget').hide();
            getPaintingsRequest();

            return;
        }

        if (typeCatalog == 'orders-paintings') {
            $('#dashbord-baget').hide();
            getOrdersPaintingsRequest();

            return;
        }

        if (typeCatalog == 'gallery-works') {
            $('#dashbord-baget').hide();
            getGalleryWorksRequest();

            return;
        }

        if (typeCatalog == 'feed-back') {
            $('#dashbord-baget').hide();
            getFeedBackRequest();

            return;
        }

        $('#' + typeCatalog).html(spiner);
        $('#dashbord-baget').show();
        $('#searchId').val('');
        $('#searchPrice').val('');
        $('#sort').val('');

        $.ajax({
            url: '/admin/request/getCatalog.php',
            method: 'post',
            data: {
                typeCatalog: typeCatalog,
            },
            success: function (data) {
                $('#' + typeCatalog).html(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });

    }

    // заявки на картины
    function getFeedBackRequest() {
        $.ajax({
            url: '/admin/request/getFeedBackTable.php',
            method: 'post',
            success: function (data) {
                $('#feed-back').html(data);
                let table = $('#feed-back-table').dataTable({
                    "language": languageTables
                });
                table.fnSort([
                    [0, 'desc']
                ]);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }
    // Удаление элемента из конструктора
    function deleteItemRequest(idItem, el) {
        $.ajax({
            url: '/admin/request/removeItem.php',
            method: 'post',
            data: {
                idItem: idItem,
            },
            success: function (data) {
                //if (data == '1') {
                el.parent().parent().remove()
                alert('Удалено')
                // }
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Поиск по ID
    function searchId() {
        $('.vendor').each(function (i, obj) {
            let str = $(this).text()
            if (str.indexOf($('#searchId').val()) == -1) {
                $(this).parent().parent().parent().hide()
            } else {
                $(this).parent().parent().parent().show()
            }
        });
    }

    // Поиск по цене
    function searchPrice() {
        $('.price').each(function (i, obj) {
            let str = $(this).text()
            if (str.indexOf($('#searchPrice').val()) == -1) {
                $(this).parent().parent().parent().hide()
            } else {
                $(this).parent().parent().parent().show()
            }
        });
    }

    // Сортировка
    function sortRequest() {
        $('#' + $('.tab-pane.active').attr('id')).html(spiner);
        $.ajax({
            url: '/admin/request/getCatalog.php',
            method: 'post',
            data: {
                typeCatalog: $('.tab-pane.active').attr('id'),
                sort: $('#sort').val()
            },
            success: function (data) {
                $('#' + $('.tab-pane.active').attr('id')).html(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Инициализация формы на изменение
    function initChangeItem(idItem, el) {
        let card = el.parent().parent();

        let priceItem = card.find('.price');
        let widthItem = card.find('.width');
        let widthwithoutItem = card.find('.widthwithout');
        let storageItem = card.find('.storage');
        let colorItem = card.find('.color');

        let price = priceItem.text()
        let width = widthItem.text()
        let widthwithout = widthwithoutItem.text()
        let storage = storageItem.text()
        let color = colorItem.text()

        priceItem.replaceWith('<input type="text" class="input-change-sm price" value="' + price + '">');
        widthItem.replaceWith('<input type="text" class="input-change-sm width" value="' + width + '">');
        widthwithoutItem.replaceWith('<input type="text" class="input-change-sm widthwithout" value="' + widthwithout + '">');
        storageItem.replaceWith('<input type="text" class="input-change-sm storage" value="' + storage + '">');
        colorItem.replaceWith('<input type="text" class="input-change color" value="' + color + '">');

        el.text("Сохранить");
        el.removeClass("change");
        el.addClass("save-change");
    }

    // Изменение
    function changeItemRequest(idItem, el) {
        let card = el.parent().parent();

        let priceItem = card.find('.price');
        let widthItem = card.find('.width');
        let widthwithoutItem = card.find('.widthwithout');
        let storageItem = card.find('.storage');
        let colorItem = card.find('.color');

        let price = priceItem.val()
        let width = widthItem.val()
        let widthwithout = widthwithoutItem.val()
        let storage = storageItem.val()
        let color = colorItem.val()

        priceItem.replaceWith('<span class="price">' + price + '</span>');
        widthItem.replaceWith('<span class="width">' + width + '</span>');
        widthwithoutItem.replaceWith('<span class="widthwithout">' + widthwithout + '</span>');
        storageItem.replaceWith('<span class="storage">' + storage + '</span>');
        colorItem.replaceWith('<span class="color">' + color + '</span>');

        info = {
            price: price,
            width: width,
            widthwithout: widthwithout,
            storage: storage,
            color: color,
            id: idItem,
        }

        $.ajax({
            url: '/admin/request/changeItem.php',
            method: 'post',
            data: info,
            success: function (data) {
                console.log(data)
                alert('Изменено');
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });

        el.text("Изменить");
        el.removeClass("save-change");
        el.addClass("change");
    }

    // Статистика
    function getStaticRequest() {
        $('#static').html('Статистика');
        $.ajax({
            url: '/admin/request/staticCatalog.php',
            method: 'post',
            data: {
                static: 'static',
            },
            success: function (data) {
                $('#static').html(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Промокоды
    function getinfoPromoCodeRequest() {
        $('#promokod-container').html(spiner);

        $.ajax({
            url: '/admin/request/getInfoPromoKods.php',
            method: 'post',
            data: {},
            success: function (data) {
                $('#promokod-container').html(data);
                $('#promo-kods-table').dataTable({
                    "language": languageTables
                });
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
        //TO DO
    }

    // Добавление в каталог
    function addItemCatalogRequest() {
        $('#type_catalog').removeClass('is-invalid');
        $('#imgConst').removeClass('is-invalid');
        $('#listImg').removeClass('is-invalid');
        $('#price').removeClass('is-invalid');
        $('#width').removeClass('is-invalid');
        $('#quarter').removeClass('is-invalid');

        if ($('#type_catalog option:selected').val() == '') {
            alert('Необходимо заполнить поле "Тип" !');
            $('#type_catalog').addClass('is-invalid');

            return;
        }

        if ($('#imgConst').val() == '') {
            alert('Необходимо заполнить поле "Картинка для рамы" !');
            $('#imgConst').addClass('is-invalid');

            return;
        }

        if ($('#listImg').val() == '') {
            alert('Необходимо заполнить поле "Картинка для каталога" !');
            $('#listImg').addClass('is-invalid');

            return;
        }

        if ($('#price').val() == '') {
            alert('Необходимо заполнить поле "Цена" !');
            $('#price').addClass('is-invalid');

            return;
        }

        if ($('#width').val() == '') {
            alert('Необходимо заполнить поле "Ширина" !');
            $('#width').addClass('is-invalid');

            return;
        }

        if ($('#quarter').val() == '') {
            alert('Необходимо заполнить поле "Без четверти" !');
            $('#quarter').addClass('is-invalid');

            return;
        }

        if ($('#color').val() == '') {
            $('#color').val('Без названия');
        }

        $('#color').prop('disabled', false);
        $('#width').prop('disabled', false);
        $('#quarter').prop('disabled', false);

        let formData = new FormData($('#addItemInCatalog')[0])

        $.ajax({
            url: '/admin/request/addItemCatalogSave.php',
            method: 'post',
            cache: false,
            contentType: false,
            processData: false,
            data: formData,
            success: function (data) {
                if (data == 'success') {
                    alert('Добавлено !');
                }
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Добавление новой работы
    function addItemGalleryWorksRequest() {
        let formData = new FormData($('#addItemGalleryWorks')[0])

        $.ajax({
            url: '/admin/request/galleryWorks/addItemCatalogSave.php',
            method: 'post',
            cache: false,
            contentType: false,
            processData: false,
            data: formData,
            success: function (data) {
                if (data == 'success') {
                    alert('Добавлено !');
                }
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // изменение типа при добавлении в каталог
    function changeTypeCatalog() {
        if ($('#type_catalog option:selected').val() == 'pasp') {
            $('#width').val(0);
            $('#quarter').val(0);
            $('#width').prop('disabled', true);
            $('#quarter').prop('disabled', true);
            $('#color').prop('disabled', false);
        } else {
            $('#width').prop('disabled', false);
            $('#quarter').prop('disabled', false);
            $('#color').prop('disabled', true);
        }
    }

    // Удаление промокода
    function deletePromoKodRequest(idItem, el) {
        $.ajax({
            url: '/admin/request/removePromoKod.php',
            method: 'post',
            data: {
                idItem: idItem,
            },
            success: function (data) {
                el.parent().parent().remove()
                alert('Удалено')
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Инициализация формы на изменение
    function initChangePromokodItem(idItem, el) {
        let card = el.parent().parent();

        let promokodItem = card.find('.promokod');
        let procentItem = card.find('.procent');
        let countItem = card.find('.count');
        let activeItem = card.find('.active');

        let promokod = promokodItem.text()
        let procent = procentItem.text()
        let count = countItem.text()
        let active = activeItem.text()

        procent = procent == "0" ? '' : procent;
        count = count == "0" ? '' : count;

        promokodItem.replaceWith('<input type="text" class="input-change-sm promokod" value="' + promokod + '">');
        procentItem.replaceWith('<input type="text" class="input-change-sm procent" value="' + procent + '">');
        countItem.replaceWith('<input type="text" class="input-change-sm count" value="' + count + '">');
        activeItem.replaceWith('<select class="form-select active" aria-label="Default select example"><option selected value="">не выбрано</option><option value="активный">активный</option> <option value="не активный">не активный</option></select>');

        el.text("Сохранить");
        el.removeClass("init-change-promo-kod");
        el.addClass("save-change-promokod");
    }

    // Изменение
    function changePromokodRequest(idItem, el) {
        let card = el.parent().parent();

        let promokodItem = card.find('.promokod');
        let procentItem = card.find('.procent');
        let countItem = card.find('.count');
        let activeItem = card.find('.active');

        let promokod = promokodItem.val()
        let procent = procentItem.val()
        let count = countItem.val()
        let active = activeItem.val()

        if (procent == '' && count == '') {
            alert('Необходимо заполнить одну из скидок !');
            procentItem.addClass('is-invalid');
            countItem.addClass('is-invalid');

            return;
        }

        if (procent != '' && count != '') {
            alert('Можно заполнить одну из скидок ! (заполнено 2)');
            procentItem.addClass('is-invalid');
            countItem.addClass('is-invalid');

            return;
        }

        if (active == '') {
            alert('Необходимо заполнить поле "Активация" !');
            activeItem.addClass('is-invalid');

            return;
        }

        promokodItem.replaceWith('<span class="promokod">' + promokod + '</span>');
        procentItem.replaceWith('<span class="procent">' + procent + '</span>');
        countItem.replaceWith('<span class="count">' + count + '</span>');
        activeItem.replaceWith('<span class="active">' + active + '</span>');



        if (active == 'не выбрано' || active == 'не активный') {
            active = '0';
        }

        if (active == 'активный') {
            active = '1';
        }

        info = {
            series_id: promokod,
            sale_procent: procent,
            sale_count: count,
            active: active,
        }

        console.log(info);
        $.ajax({
            url: '/admin/request/changePromoKod.php',
            method: 'post',
            data: info,
            success: function (data) {
                console.log(data)
                alert('Изменено');
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });

        el.text("Изменить");
        el.removeClass("save-change-promokod");
        el.addClass("init-change-promo-kod");
    }

    // Добавление промкода
    function addPromoKodRequest() {
        $('#series_id').removeClass('is-invalid');
        $('#sale_procent').removeClass('is-invalid');
        $('#sale_count').removeClass('is-invalid');
        $('#active').removeClass('is-invalid');

        if ($('#active option:selected').val() == '') {
            alert('Необходимо заполнить поле "Активация" !');
            $('#active').addClass('is-invalid');

            return;
        }

        if ($('#series_id').val() == '') {
            alert('Необходимо заполнить поле "промокод" !');
            $('#series_id').addClass('is-invalid');

            return;
        }

        if ($('#sale_procent').val() == '' && $('#sale_count').val() == '') {
            alert('Необходимо заполнить одну из скидок !');
            $('#sale_procent').addClass('is-invalid');
            $('#sale_count').addClass('is-invalid');

            return;
        }

        if ($('#sale_procent').val() != '' && $('#sale_count').val() != '') {
            alert('Можно заполнить одну из скидок ! (заполнено 2)');
            $('#sale_procent').addClass('is-invalid');
            $('#sale_count').addClass('is-invalid');

            return;
        }
        let active = $('#active').val();

        if (active == 'не выбрано' || active == 'не активный') {
            active = '0';
        }

        if (active == 'активный') {
            active = '1';
        }

        info = {
            series_id: $('#series_id').val(),
            sale_procent: $('#sale_procent').val(),
            sale_count: $('#sale_count').val(),
            active: active,
        }

        $.ajax({
            url: '/admin/request/addPromoKodSave.php',
            method: 'post',
            data: info,
            success: function (data) {
                if (data == 'success') {
                    alert('Добавлено !');
                }
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // картины
    function getPaintingsRequest() {
        $('#paintings').html('Готовые картины');
        $.ajax({
            url: '/admin/request/paintingsCatalog.php',
            method: 'post',
            data: {
                static: 'static',
            },
            success: function (data) {
                $('#paintings').html(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // картины
    function getPaintingsByIdUrlRequest(id) {
        $('#paintings').html('Готовые картины');
        $.ajax({
            url: '/admin/request/paintingsCatalogById.php',
            method: 'post',
            data: {
                id: id,
            },
            success: function (data) {
                $('#paintings').html(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // заявки на картины
    function getOrdersPaintingsRequest() {
        console.log(123)
        $.ajax({
            url: '/admin/request/getOrdersPaintingsCatalog.php',
            method: 'post',
            success: function (data) {
                $('#orders-paintings').html(data);
                $('#orders-paintings-table').dataTable({
                    "language": languageTables
                });
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // ГалереяРабот
    function getGalleryWorksRequest() {
        $.ajax({
            url: '/admin/request/galleryWorks/getJsonListGalleryWorks.php',
            method: 'post',
            dataType: "json",
            data: {
                categoryId : $('#selectCategoryGalleryWorks').val()
            },
            async: true,
            success: function (data) {
                tableGalleryWorks.fnClearTable();
                tableGalleryWorks.fnAddData(data);
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    //Изменение описания
    function changeDescGalleryWorks(el) {
        $.ajax({
            url: '/admin/request/galleryWorks/setDescGalleryWorks.php',
            method: 'post',
            data: {
                description: el.val(),
                id: el.data('id-works'),
            },
            success: function (data) {
                console.log(data)
                toastr.success('Изменено');
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    // Добавление картины
    function addPaintingCatalogRequest() {
        $('#painting_name').removeClass('is-invalid');
        $('#painting_avtor').removeClass('is-invalid');
        $('#painting_size').removeClass('is-invalid');
        $('#painting_price').removeClass('is-invalid');

        if ($('#painting_name').val() == '') {
            alert('Необходимо заполнить поле "Название" !');
            $('#painting_name').addClass('is-invalid');

            return;
        }

        if ($('#painting_avtor').val() == '') {
            alert('Необходимо заполнить поле "Автор" !');
            $('#painting_avtor').addClass('is-invalid');

            return;
        }

        if ($('#painting_size').val() == '') {
            alert('Необходимо заполнить поле "Размер" !');
            $('#painting_size').addClass('is-invalid');

            return;
        }

        if ($('#painting_price').val() == '') {
            alert('Необходимо заполнить поле "Цена" !');
            $('#painting_price').addClass('is-invalid');

            return;
        }

        let formData = new FormData($('#addPaintingInCatalog')[0])

        $.ajax({
            url: '/admin/request/addPaintingCatalogSave.php',
            method: 'post',
            cache: false,
            contentType: false,
            processData: false,
            data: formData,
            success: function (data) {
                if (data == 'success') {
                    alert('Добавлено !');
                }
            },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect. Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found (404).');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error (500).');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error. ' + jqXHR.responseText);
                }
            }
        });
    }

    /**
     * Список событий
     */
    $(document).on('click', '.nav-link', function () {
        getCatalogRequest($(this).data('type'))
    }); // Переключение табов
    $(document).on('click', '.delete', function () {
        deleteItemRequest($(this).data('id'), $(this))
    }); // Удаление элемента в каталоге
    $(document).on('click', '.delete-promo-kod', function () {
        deletePromoKodRequest($(this).data('series'), $(this))
    }); // Удаление промокода
    $(document).on('click', '.change', function () {
        initChangeItem($(this).data('id'), $(this))
    }); // Разрешить редактирование карточки
    $(document).on('click', '.init-change-promo-kod', function () {
        initChangePromokodItem($(this).data('id'), $(this))
    }); // Разрешить редактирование промокода
    $(document).on('click', '.save-change', function () {
        changeItemRequest($(this).data('id'), $(this))
    }); // Запрос на сохранение изменений
    $(document).on('click', '.save-change-promokod', function () {
        changePromokodRequest($(this).data('id'), $(this))
    }); // Запрос на сохранение изменений
    $(document).on('click', '#add-catalog-save', function () {
        addItemCatalogRequest()
    }); // Запрос на добавление в каталог
    $(document).on('click', '#add-gallery-works-save', function () {
        addItemGalleryWorksRequest()
    }); // Запрос на добавление в каталог
    $(document).on('click', '#add-promokod-save', function () {
        addPromoKodRequest()
    }); // Запрос на добавление в каталог
    $(document).on('keyup', '#searchId', function () {
        searchId()
    }); // Поиск артикул
    $(document).on('keyup', '#searchPrice', function () {
        searchPrice()
    }); // Поиск цена
    $(document).on('change', '#sort', function () {
        sortRequest()
    }); // Сортировка
    $(document).on('change', '#type_catalog', function () {
        changeTypeCatalog()
    }); // Сортировка
    $(document).on('change', '#selectCategoryGalleryWorks', function () {
        getGalleryWorksRequest()()
    }); // Сортировка
    $(document).on('click', '#add-painting-save', function () {
        addPaintingCatalogRequest()
    }); // Запрос на добавление новой картины
    $(document).on('change', '.edit-description-gallery-works', function () {
        changeDescGalleryWorks($(this))
    }); // Изменение описания готовой работы
})